(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1859],{89506:function(e,t,n){"use strict";n.d(t,{T:function(){return l}});var i=n(87757),r=n.n(i),s=n(92137),a=n(8379),o=n.n(a),c=n(80248),l=function(e){var t=e.selfID,n=e.recipientID,i=e.selfName,a=e.recipientName,c=e.selfPhoto,l=e.recipientPhoto;return new Promise(function(){var e=(0,s.Z)(r().mark((function e(s,d){var f,h,m;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f=o()(),e.next=3,u({userID:t,chatroomID:f,recipientID:n,recipientName:a,recipientPhoto:l});case 3:return h=e.sent,e.next=6,u({userID:n,chatroomID:f,recipientID:t,recipientName:i,recipientPhoto:c});case 6:m=e.sent,h&&d(h),m&&d(m),s(f);case 10:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}())},u=function(){var e=(0,s.Z)(r().mark((function e(t){var n,i;return r().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c.O.from("conversations").insert(t,{returning:"minimal"});case 3:if(n=e.sent,!(i=n.error)){e.next=7;break}throw i;case 7:e.next=12;break;case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return",e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t){return e.apply(this,arguments)}}()},70402:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return M}});var i=n(85893),r=n(87757),s=n.n(r),a=n(92137),o=n(65988),c=n(67294),l=n(88866),u=n(14670),d=n(8286),f=n(41120),h=n(13457),m=n(18463),x=n(99956),g=n(7397),p=n(17812),v=n(17213),_=n(79065),b=n(48150),w=n(6222),j=(n(57525),n(85073)),y=n.n(j),I=n(25635),k=n(15503),D=(n(24140),n(14642),n(13558)),S=(n(30381),n(69476)),N=n(9936),Z=n(63457),E=n(9525),C=n.n(E),P=n(37723);var A=function(e){var t=e.loading,n=(0,c.useState)(!0),r=n[0],s=n[1],a=(0,Z.Z)(v.Z.breakpoints.down("sm"));return(0,c.useEffect)((function(){s(t)}),[t]),(0,i.jsxs)("div",{style:{width:"100vw",height:"100vh",display:"flex",flexDirection:a?"column-reverse":"row",position:"absolute",top:0,bottom:0,left:0,right:0,alignItems:"center",justifyContent:"center",zIndex:99999},className:"jsx-3305584780",children:[(0,i.jsx)(P.Z,{in:r,timeout:700,unmountOnExit:!0,classNames:{enter:C().enter,enterActive:C().enterActive,exit:C().exit,exitActive:C().exitActive},children:(0,i.jsx)("div",{className:"jsx-3305584780 "+(C().container||""),children:(0,i.jsx)(b.Ee,{src:"/giggersmy-assets/loading-new.svg",width:80,height:80,alt:""})})}),(0,i.jsx)(o.default,{id:"3305584780",children:["body{margin:0;}"]})]})},R=n(2823),O=n.n(R),F=n(94537),z=n(86010),T=(n(89506),n(80248)),W=n(11163),q=(0,u.Z)({root:{"& .MuiTextField-root":{fontFamily:"Poppins, sans-serif",fontSize:"0.9rem"},"& .MuiInputBase-root":{fontFamily:"Poppins, sans-serif",color:"white"},"& .MuiOutlinedInput-root":{borderRadius:"30px",fontSize:"0.9rem",backgroundColor:"white"},"& .MuiOutlinedInput-input":{color:"#323232"}}})(d.Z);var M=function(){(0,D.a)().authUser;var e=(0,c.useState)(!0),t=e[0],n=e[1],r=(0,c.useState)(!1),u=(r[0],r[1]),d=(0,c.useState)(""),j=d[0],Z=d[1],E=(0,c.useState)([]),C=E[0],R=E[1],M=(0,c.useState)(!1),J=(M[0],M[1],(0,c.useState)(null)),X=J[0],B=J[1],U=(0,c.useState)(null),Y=U[0],L=U[1],Q=(0,c.useState)(""),G=Q[0],H=Q[1],K=(0,w.a)(),V=K.user,$=(K.logout,(0,c.useState)(550)),ee=$[0],te=$[1],ne=(0,c.useRef)(null),ie=((0,W.useRouter)().query.roomID,(0,N.qJ)()),re=(0,f.Z)((function(){return{scrollDiv:{height:"calc(".concat(ee,"px - 135px)"),backgroundColor:"#e1e2e3",overflowY:"auto"}}}))();(0,c.useEffect)((function(){setTimeout((function(){n(!1)}),1e3)}),[V]),(0,c.useEffect)((function(){!1===t&&se()}),[t]),(0,c.useEffect)((function(){console.log("Listening chat of ID ".concat(j));var e=null;return""!==j&&(e=k.Z.database().ref("messages/"+j)).on("value",(function(e){var t=e.val();L(null!==t?Object.values(t):null)})),function(){null!=e&&e.off()}}),[j]),(0,c.useEffect)((function(){}),[]),(0,c.useEffect)((function(){ie()}),[Y]),(0,c.useEffect)((function(){if(ne.current){var e=ne.current.clientHeight;ne.current.clientWidth;te(e)}}),[ne.current,ne.current?ne.current.clientHeight:0]);var se=function(){var e=(0,a.Z)(s().mark((function e(){var t,n,i,r,a;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,u(!0),e.next=4,new Promise((function(e){return setTimeout(e,1e3)}));case 4:return e.next=6,T.O.from("conversations").select().eq("userID",V.id);case 6:if(t=e.sent,n=t.data,i=t.error,r=t.status,!i||406===r){e.next=12;break}throw i;case 12:n&&(console.log(n),a=n.map((function(e){return{chatroomID:e.chatroomID,name:e.recipientName,recipientID:e.recipientID,profilePic:e.recipientPhoto,disabled:!1}})),R(a)),e.next=18;break;case 15:e.prev=15,e.t0=e.catch(0),alert(e.t0.message);case 18:return e.prev=18,u(!1),e.finish(18);case 21:case"end":return e.stop()}}),e,null,[[0,15,18,21]])})));return function(){return e.apply(this,arguments)}}(),ae=function(){var e=(0,a.Z)(s().mark((function e(t){var n,i;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),""!==j&&""!==G&&(n={chatroomid:j,userid:V.id,message:G,avatar_url:V.profilePic,timestamp:new Date},i=k.Z.database().ref("messages/"+j),i.push().set(n).then((function(){H("")})).catch((function(e){console.log(e),alert("An error has occured")})));case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return t?(0,i.jsx)(A,{loading:t}):(0,i.jsxs)(h.Z,{theme:v.Z,children:[(0,i.jsxs)("div",{style:{width:"100%",height:"100vh",display:"flex",flexDirection:"column",overflowY:"auto",backgroundColor:"#fbfbfd"},className:"jsx-3254708183",children:[(0,i.jsx)(l.Z,{}),(0,i.jsx)("div",{style:{width:"fit-content",height:"fit-content",paddingLeft:50,paddingRight:50},className:"jsx-3254708183",children:(0,i.jsxs)(m.Z,{ref:ne,className:(0,z.Z)(y().mainCard),style:{borderRadius:15,backgroundColor:"#FAFBFC"},variant:"outlined",children:[(0,i.jsx)("div",{style:{height:550,width:400,zIndex:1e3},className:"jsx-3254708183",children:(0,i.jsxs)("div",{style:{width:"100%",height:"calc(".concat(ee,"px - 60px)"),overflowY:"auto",overflowX:"auto",padding:15},className:"jsx-3254708183",children:[(0,i.jsx)(x.Z,{style:{width:"100%",height:"fit-content",borderRadius:10,marginBottom:20},children:(0,i.jsx)(q,{variant:"outlined",fullWidth:!0,size:"small",placeholder:"Search",InputProps:{startAdornment:(0,i.jsx)(g.Z,{position:"start",children:(0,i.jsx)(S.Z,{style:{color:"#323232"}})})}})}),C.map((function(e,t){return(0,i.jsxs)(x.Z,{className:C.length>0&&e.disabled?y().selected:y().unselected,onClick:function(){return function(e){var t=C.map((function(e){return{chatroomID:e.chatroomID,name:e.name,recipientID:e.recipientID,profilePic:e.profilePic,disabled:!1}}));console.log(C),console.log(e),t[e].disabled=!0,R(t),Z(C[e].chatroomID),console.log(j),B({name:C[e].name,photoURL:C[e].profilePic,chatroomID:C[e].chatroomID,recipientID:C[e].recipientID}),console.log(X)}(t)},children:[(0,i.jsx)(b.Ee,{alt:"ProfilePic",src:e.profilePic,height:40,width:40,style:{borderRadius:"50%",marginRight:10}}),(0,i.jsxs)("div",{className:"jsx-3254708183",children:[(0,i.jsx)(_.q,{fontFamily:"Poppins, sans-serif",fontWeight:800,color:C.length>0?e.disabled?"#fff":"#323232":"",children:e.name}),(0,i.jsx)(_.q,{fontFamily:"Poppins, sans-serif",fontSize:"0.8rem",color:C.length>0?e.disabled?"#aaa":"#606060":"",children:"Hello"})]})]},"conversation-".concat(t))}))]})}),(0,i.jsx)("div",{style:{width:"calc(100vw - 502px)"},className:"jsx-3254708183",children:""!==j?(0,i.jsxs)(m.Z,{variant:"outlined",style:{height:550,width:"100%",borderRadius:15,display:"flex",flexDirection:"column",backgroundColor:"#fff0"},children:[(0,i.jsxs)(x.Z,{style:{height:70,width:"100%",display:"flex",alignItems:"center",paddingLeft:10,backgroundColor:"#323232"},children:[(0,i.jsx)(b.Ee,{alt:"",src:null!==X?X.photoURL:"",style:{borderRadius:"50%",height:50,width:50,marginRight:10}}),(0,i.jsx)(_.q,{color:"#fff",fontSize:"1rem",fontFamily:"Poppins, sans-serif",fontWeight:700,children:null!==X?X.name:""})]}),(0,i.jsx)(N.ZP,{className:re.scrollDiv,children:(0,i.jsx)(F.Z,{children:null!=Y?Y.map((function(e,t){return(0,i.jsx)(P.Z,{in:!0,timeout:500,classNames:{enter:O().enter,enterActive:O().enterActive,exit:O().exit,exitActive:O().exitActive},children:(0,i.jsxs)("div",{className:"jsx-3254708183 "+((e.userid===V.id?y().messageSelf:y().messageSender)||""),children:[(0,i.jsx)(b.Ee,{alt:"",src:e.avatar_url,style:{borderRadius:"50%",width:32,height:32,alignSelf:"flex-end"}}),(0,i.jsx)(x.Z,{boxShadow:5,className:e.userid===V.id?y().messageItemSelf:y().messageItemSender,children:e.message})]})},"message-".concat(t))})):null})}),(0,i.jsx)("div",{style:{backgroundColor:"#e1e2e3",padding:5},className:"jsx-3254708183",children:(0,i.jsxs)("form",{style:{display:"flex",borderRadius:30,position:"relative",backgroundColor:"#fff0"},onSubmit:function(e){return ae(e)},className:"jsx-3254708183",children:[(0,i.jsx)(q,{variant:"outlined",fullWidth:!0,placeholder:"Type your message here...",style:{marginRight:5},value:G,onChange:function(e){return H(e.target.value)}}),(0,i.jsx)(p.Z,{type:"submit",style:{border:"1px solid #00b09b77",width:"fit-content",height:"fit-content",position:"absolute",right:8,alignSelf:"center",backgroundColor:"#00c2cb"},children:(0,i.jsx)(I.Z,{style:{color:"#fff"}})})]})})]}):(0,i.jsxs)(m.Z,{style:{height:550,width:"100%",display:"flex",flexDirection:"column",backgroundColor:"#fff",alignItems:"center",justifyContent:"center"},children:[(0,i.jsx)(b.Ee,{alt:"",src:"../giggersmy-assets/chat.svg",width:300,height:300,marginBottom:10}),(0,i.jsx)(_.q,{color:"#333",fontFamily:"Inter, sans-serif",fontSize:"1.5rem",fontWeight:700,children:"Start Your Conversation"}),(0,i.jsx)(_.q,{color:"#aaa",children:"Never share your private information with anyone."})]})})]})})]}),(0,i.jsx)(o.default,{id:"3254708183",children:["html{width:100%;height:100%;}","body{width:100%;height:100%;margin:0;padding:0;}","#__next{height:100%;width:100%;}","::-webkit-scrollbar{width:7px;height:7px;}","::-webkit-scrollbar-track{box-shadow:inset 0 0 5px grey;border-radius:10px;}","::-webkit-scrollbar-thumb{background:#aaa;border-radius:10px;}","::-webkit-scrollbar-thumb:hover{background:#777;}",".MuiPaper-outlined{border:1px solid #ccc;}"]})]})}},80248:function(e,t,n){"use strict";n.d(t,{O:function(){return i}});var i=(0,n(15550).eI)("https://qhjimwxbhftmcxmkutrf.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoiYW5vbiIsImlhdCI6MTYyOTI4MTQzNywiZXhwIjoxOTQ0ODU3NDM3fQ.0GbmbjU55zxs50F8cOgPFbfXhWZB8c_wSk9cwf0rT5k")},44043:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/user/messages",function(){return n(70402)}])},57525:function(){"use strict"},9525:function(e){e.exports={container:"loading_container__Svdn5",enter:"loading_enter__38Gvx",enterActive:"loading_enterActive__CpxF6",exit:"loading_exit__1uIdW",exitActive:"loading_exitActive__1hs3d"}},2823:function(e){e.exports={enter:"anim_enter__RCfOv",enterActive:"anim_enterActive__sexcE",exit:"anim_exit__3AFgR",exitActive:"anim_exitActive__2yJDE",cardEnter:"anim_cardEnter__2fj24",cardEnterActive:"anim_cardEnterActive__32Nhd",cardExit:"anim_cardExit__1wuhJ",cardExitActive:"anim_cardExitActive__1zEhF"}},85073:function(e){e.exports={unselected:"messages_unselected__AKuWQ",selected:"messages_selected__Kfwla",messageSelf:"messages_messageSelf__2ibMQ",messageItemSelf:"messages_messageItemSelf__1K74n",messageSender:"messages_messageSender__1Os3l",messageItemSender:"messages_messageItemSender__xfh9m",loading:"messages_loading__1CWqk",mainCard:"messages_mainCard__3kI9-",original:"messages_original__-VXly",hide:"messages_hide__2BzW9"}}},function(e){e.O(0,[4885,7755,4223,3218,511,177,4422,8794,5550,1555,8866,9774,2888,179],(function(){return t=44043,e(e.s=t);var t}));var t=e.O();_N_E=t}]);